@page "/components/fileinput"
@page "/components/file-input"

<PageOutlet Url="components/fileinput"
            Title="FileInput"
            Description="fileinput component of the bit BlazorUI components" />

<DemoPage Name="FileInput"
          Description="BitFileInput component wraps the HTML file input element and allows the user to select file(s) without uploading them. The selected files are returned to the C# context for further processing. It provides several options including single or multiple file selection, drag and drop support, file size validation, and file extension filtering."
          Parameters="componentParameters"
          SubClasses="componentSubClasses"
          PublicMembers="componentPublicMembers"
          GitHubUrl="Inputs/FileInput/BitFileInput.razor"
          GitHubDemoUrl="Inputs/FileInput/BitFileInputDemo.razor">
    <DemoExample Title="Basic" RazorCode="@example1RazorCode" Id="example1">
        <div>Select file(s) to see them in the component.</div>

        <br />

        <BitFileInput Label="Browse or drop a file" />
    </DemoExample>

    <DemoExample Title="Multiple" RazorCode="@example2RazorCode" Id="example2">
        <div>Multiple files can be selected.</div>

        <br />

        <BitFileInput Label="Browse or drop files" Multiple />
    </DemoExample>

    <DemoExample Title="AutoReset" RazorCode="@example3RazorCode" Id="example3">
        <div>Automatically resets the BitFileInput state each time before browsing files.</div>

        <br />

        <BitFileInput Label="Browse or drop a file" AutoReset />
    </DemoExample>

    <DemoExample Title="Append" RazorCode="@example4RazorCode" Id="example4">
        <div>When selected, additional files will be appended to the existing list without overwriting previous selections.</div>

        <br />

        <BitFileInput Label="Browse or drop a file" Append />
    </DemoExample>

    <DemoExample Title="MaxSize" RazorCode="@example5RazorCode" Id="example5">
        <div>The file size can be limited using the MaxSize parameter (1 MB in this example).</div>

        <br />

        <BitFileInput Label="Browse or drop a file" MaxSize="1024 * 1024 * 1" />
    </DemoExample>

    <DemoExample Title="AllowedExtensions" RazorCode="@example6RazorCode" Id="example6">
        <div>Limits file browsing by the provided file extensions.</div>

        <br />

        <BitFileInput Label="Browse or drop a file" AllowedExtensions="@([".gif", ".jpg", ".png", ".bmp"])" />
    </DemoExample>

    <DemoExample Title="Removable" RazorCode="@example7RazorCode" Id="example7">
        <div>Enables the remove functionality of the BitFileInput.</div>

        <br />

        <BitFileInput Label="Browse or drop a file" ShowRemoveButton />
    </DemoExample>

    <DemoExample Title="Events" RazorCode="@example8RazorCode" CsharpCode="@example8CsharpCode" Id="example8">
        <div>Use OnChange to handle file selection and ReadContentAsync to access the file's byte array content.</div>

        <br />

        <BitFileInput @ref="eventsFileInput" Label="Select or drag and drop files" OnChange="@HandleOnChange" />
        
        <br />
        <br />

        <div>Selected files:</div>
        <br />
        @foreach (var file in selectedFiles)
        {
            <div>
                @file.Name (@FileSizeHumanizer.Humanize(file.Size))
                @if (file.Content is not null)
                {
                    <span> - @file.Content.Length bytes loaded</span>
                }
            </div>
        }
    </DemoExample>

    <DemoExample Title="Templates" RazorCode="@example9RazorCode" CsharpCode="@example9CsharpCode" Id="example9">
        <div>The BitFileInput can be further customized using templates.</div>

        <br />

        <BitFileInput @ref="bitFileInput" Multiple
                      MaxSize="1024 * 1024 * 2"
                      AllowedExtensions="@([".jpg", ".jpeg", ".png", ".bmp"])">
            <LabelTemplate>
                @if (bitFileInput.Files?.Any() is not true)
                {
                    <div class="browse-file" @onclick="() => bitFileInput.Browse()">
                        <div class="browse-file-header">
                            <i class="bit-icon bit-icon--CloudUpload" />
                            <div>
                                Drag and drop or
                            </div>
                            <div>
                                <strong>
                                    Browse files
                                </strong>
                            </div>
                        </div>

                        <div class="browse-file-footer">
                            <div>Max file size: 2 MB</div>
                            <div>Supported file types: jpg, jpeg, png, bmp</div>
                        </div>
                    </div>
                }
            </LabelTemplate>
            <FileViewTemplate Context="file">
                @if (!string.IsNullOrEmpty(file.Name))
                {
                    <div class="file-list">
                        <div class="file-list-header">
                            <div class="file-info">
                                <div class="file-info-main">
                                    <i class="bit-icon bit-icon--Page" />
                                    <div class="file-info-data">
                                        <div class="file-info-name">
                                            @file.Name
                                        </div>
                                        <div>
                                            @FileSizeHumanizer.Humanize(file.Size)
                                        </div>
                                    </div>
                                </div>

                                <div class="file-info-btns">
                                    <i class="bit-icon bit-icon--Cancel remove-ico"
                                       @onclick="() => bitFileInput.RemoveFile(file)" />
                                </div>
                            </div>

                            @if (!file.IsValid)
                            {
                                <div class="file-info-e-msg">@file.Message</div>
                            }
                        </div>

                        <div class="file-list-footer">
                            <div>Max file size: 2 MB</div>
                            <div>Supported file types: jpg, jpeg, png, bmp</div>
                        </div>
                    </div>
                }
            </FileViewTemplate>
        </BitFileInput>
    </DemoExample>

    <DemoExample Title="Public API" RazorCode="@example10RazorCode" CsharpCode="@example10CsharpCode" Id="example10">
        <div>Use custom methods to interact with the file input.</div>

        <br />

        <BitFileInput @ref="publicApiFileInput" HideLabel />

        <br />

        <div class="api-buttons">
            <BitButton OnClick="() => publicApiFileInput.Browse()">Browse file</BitButton>
            <BitButton OnClick="() => publicApiFileInput.Reset()">Reset</BitButton>
        </div>
    </DemoExample>

</DemoPage>
