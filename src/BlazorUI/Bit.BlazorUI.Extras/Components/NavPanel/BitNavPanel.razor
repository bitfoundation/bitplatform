@namespace Bit.BlazorUI
@inherits BitComponentBase
@typeparam TItem

@{
    var isToggled = !_isPanelOpen && _isMenuToggled;
}

<div class="bit-npn @($"{(_isPanelOpen ? "" : "closed")} {(isToggled ? "6rem" : "14rem")}")">
    @if (_isPanelOpen)
    {
        <div class="bit-npn-ovl" @onclick=CloseMenu></div>
    }
    <div Class="panel">
        <BitStack HorizontalAlign="@(isToggled ? BitAlignment.Center : BitAlignment.Start)" Grows>
            <BitStack Horizontal AutoHeight Alignment="BitAlignment.Center">
                <BitImage Src="_content/Boilerplate.Client.Core/images/bit-logo.svg"
                          Visibility="@(isToggled ? BitVisibility.Collapsed : BitVisibility.Visible)" />
                <BitSpacer Visibility="@(isToggled ? BitVisibility.Collapsed : BitVisibility.Visible)" />
                <BitButton IconOnly FixedColor
                           Class="toggle-btn"
                           Size="BitSize.Large"
                           OnClick="ToggleNavPanel"
                           Variant="BitVariant.Text"
                           IconName="ColumnRightTwoThirds"
                           Color="BitColor.TertiaryBackground" />
            </BitStack>

            <BitSearchBox @ref="_searchBoxRef"
                          Underlined Immediate DebounceTime="500"
                          OnChange="SearchNavItems"
                          Style="@(isToggled ? "display:none" : "")"
                          Styles="@(new() { Root="width:100%", InputContainer="width:100%" })" />

            @if (isToggled)
            {
                <BitButton IconOnly
                           FixedColor
                           IconName="Search"
                           Class="toggle-btn"
                           Size="BitSize.Large"
                           OnClick="ToggleForSearch"
                           Variant="BitVariant.Text"
                           Color="BitColor.TertiaryBackground" />
            }

            @if (_filteredNavItems.Count == 0)
            {
                if (isToggled is false)
                {
                    <BitText>Nothing found!</BitText>
                }
            }
            else
            {
                <BitNav FullWidth
                        IconOnly="isToggled"
                        Items="_filteredNavItems"
                        Accent="BitColor.SecondaryBackground"
                        DefaultSelectedItem="_filteredNavItems[0]"
                        OnItemClick="(BitNavItem item) => HandleNavItemClick(item)"
                        Styles="@(new() { SelectedItemContainer = "background-color: var(--bit-clr-bg-sec-active)" })" />
            }

            <BitSpacer />

            @* <Footer></Footer> *@
        </BitStack>
    </div>
</div>