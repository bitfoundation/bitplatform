@inherits AppComponentBase

<NavigationLock OnBeforeInternalNavigation="OnBeforeInternalNavigation" />

<section>
    <BitStack>
        @if (currentSession is not null)
        {
            <BitText>@Localizer[nameof(AppStrings.CurrentSession)]</BitText>
            <BitCard FullWidth>
                <BitTooltip Text="@currentSession.DeviceInfo" Position="BitTooltipPosition.Bottom">
                    <BitPersona PrimaryText="@($"{currentSession.Address} ({currentSession.IP})")"
                                SecondaryText="@GetLastSeenOn(currentSession.RenewedOn)"
                                Size="BitPersonaSize.Size48"
                                Styles="@(new() { Image = "width:50%;height:50%" })"
                                ImageInitials="@(currentSession.Privileged && currentSession.IsValid ? "✓" : "✘")"
                                CoinColor="@(currentSession.Privileged && currentSession.IsValid ? null : BitColor.TertiaryBackground)"
                                ImageUrl="@($"/_content/Boilerplate.Client.Core/images/os/{GetImageUrl(currentSession.DeviceInfo)}")"
                                Presence="@(IsOnline is null ? BitPersonaPresence.None : IsOnline is true ? BitPersonaPresence.Online : BitPersonaPresence.Offline)" />
                </BitTooltip>
            </BitCard>
        }

        @if (otherSessions is not null && otherSessions.Any())
        {
            <br />
            <BitText>@Localizer[nameof(AppStrings.OtherSessions)]</BitText>

            <BitBasicList Items="otherSessions" EnableVirtualization Class="sessions-list">
                <RowTemplate Context="session">
                    <BitCard FullWidth>
                        <BitStack Horizontal VerticalAlign="BitAlignment.Center">
                            <BitTooltip Text="@session.DeviceInfo" Position="BitTooltipPosition.Bottom">
                                <BitPersona Class="session-persona"
                                            PrimaryText="@($"{session.Address} ({session.IP})")"
                                            SecondaryText="@GetLastSeenOn(session.RenewedOn)"
                                            Size="BitPersonaSize.Size48"
                                            Presence="@GetPresence(session.RenewedOn)"
                                            Styles="@(new() { Image = "width:50%;height:50%" })"
                                            ImageInitials="@(session.Privileged && session.IsValid ? "✓" : "✘")"
                                            CoinColor="@(session.Privileged && session.IsValid ? null : BitColor.TertiaryBackground)"
                                            ImageUrl="@($"/_content/Boilerplate.Client.Core/images/os/{GetImageUrl(session.DeviceInfo)}")" />
                            </BitTooltip>
                            <BitSpacer />
                            <BitButton Variant="BitVariant.Text"
                                       OnClick="() => RevokeSession(session)"
                                       IconName="@(isWaiting ? BitIconName.Process : BitIconName.Delete)" />
                        </BitStack>
                    </BitCard>
                </RowTemplate>
            </BitBasicList>
        }
    </BitStack>
</section>
