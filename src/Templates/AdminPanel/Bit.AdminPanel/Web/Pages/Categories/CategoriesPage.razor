@using AdminPanel.Shared.Dtos.Categories

@page "/categories"
@attribute [Authorize]

@inherits AppComponentBase;

<PageTitle>@AppStrings.CategoriesPageTitle</PageTitle>
<div class="page-container">
    @if (IsLoading)
    {
        <div class="loading-container">
            <BitSpinner Size="BitSpinnerSize.Large"></BitSpinner>
        </div>
    }
    <div class="page-row">
        <h1 class="page-title">Categories</h1>
        <BitButton OnClick="CreateCategory">@AppStrings.AddCategory</BitButton>
    </div>
    <BitSearchBox Class="cat-search-box"
                  @bind-Value="CategoryNameFilter"
                  Placeholder="Search some category..."
                  InputHtmlAttributes="@(new Dictionary<string, object> {{"autofocus", true}})" />
    <div class="grid">
        <BitDataGrid ItemsProvider="@categoriesProvider" TGridItem="@CategoryDto" ResizableColumns="true" Pagination="@pagination" @ref="dataGrid">
            <BitDataGridPropertyColumn Property="@(c => c.Name)" Sortable="true" Align="BitDataGridAlign.Left">
                <ColumnOptions>
                    <BitSearchBox @bind-Value="CategoryNameFilter"
                                  Placeholder="Search on name"
                                  InputHtmlAttributes="@(new Dictionary<string, object> {{"autofocus", true}})" />
                </ColumnOptions>
            </BitDataGridPropertyColumn>
            <BitDataGridPropertyColumn Property="@(c => c.Id)" Sortable="true" Align="BitDataGridAlign.Left" />
            <BitDataGridTemplateColumn Title="Color" Align="BitDataGridAlign.Left">
                <span class="color-box" style="background-color:@(context.Color)"></span>
            </BitDataGridTemplateColumn>
            <BitDataGridTemplateColumn Title="Action" Align="BitDataGridAlign.Center">
                <BitIconButton Style="color:#605E5C;" IconName="BitIconName.Edit" OnClick="() => EditCategory(context)" Title="Edit"/>
                <BitIconButton Style="color:#605E5C;" IconName="BitIconName.Delete" OnClick="WrapHandled(() => DeleteCategory(context))" Title="Delete"/>
            </BitDataGridTemplateColumn>
        </BitDataGrid>
        <BitDataGridPaginator Value="@pagination" />
    </div>
</div>

<ConfirmMessageBox />
