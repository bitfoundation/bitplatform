@page "/add-edit-category/{Id:int?}"
@attribute [Authorize]

@inherits AppComponentBase;

<PageTitle>@AppStrings.EditCategory (@Category?.Name)</PageTitle>

<div class="page-container">
    <div class="page-header">
        <BitIconButton Class="back-btn" Href="/categories" IconName="BitIconName.Back" Title="Back"/>
        <h1 class="page-title">
            @if (Category?.Id == 0)
            {
                @AppStrings.AddCategory
            }
            else
            {
                @AppStrings.EditCategory
            }
        </h1>
    </div>
    <EditForm Model="Category" OnValidSubmit="WrapHandled(Save)">
        @if (IsLoading)
        {
            <div class="loading-continaer">
                <BitSpinner Size="BitSpinnerSize.Large"></BitSpinner>
            </div>
        }
        <DataAnnotationsValidator />
        @if (string.IsNullOrEmpty(SaveMessage) is false)
        {
            <BitMessageBar Class="form-message-bar"
                       MessageBarType="@SaveMessageType"
                       OnDismiss="() => SaveMessage = null">
                @SaveMessage
            </BitMessageBar>
        }
        <div class="form-input-container">
            <BitTextField Label="@(nameof(Category.Name))" @bind-Value="Category!.Name" Placeholder="Enter category name"/>
            <ValidationMessage For="() => Category.Name" />
        </div>

        <div class="form-input-container">
            <label for="catColorInput">Color</label>
            <BitColorPicker id="catColorInput" ShowPreview="true" @bind-Color="Category!.Color">Default Color Picker</BitColorPicker>
            <ValidationMessage For="() => Category.Color" />
        </div>

        <BitButton Class="form-submit-button"
                   ButtonStyle="BitButtonStyle.Primary"
                   ButtonType="BitButtonType.Submit"
                   AriaLabel="Category">
            @if (IsSaveLoading)
            {
                <BitSpinner Size="BitSpinnerSize.Small"></BitSpinner>
            }
            else
            {
                <span>@AppStrings.Save</span>
            }
        </BitButton>

    </EditForm>
</div>

